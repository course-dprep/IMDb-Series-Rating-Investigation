---
title: "Data preparation"
output: html_document
date: "2023-09-12"
---

```{r eval=FALSE, include=FALSE}
# Load relevant packages
install.packages("tidyverse")
install.packages("dplyr")
install.packages("data.table")
library(tidyverse)
library(dplyr)
library(data.table)
```

Use 3 datasets (in no particular order):

1.title.episode.tsv.gz to get the number of seasons (length of series)

2.title.ratings.tsv.gz to get the overall rating of the show

3.title.basics.tsv.gz to get the name of the show

```{r}
#Download relevant datasets
urls = c("https://datasets.imdbws.com/title.episode.tsv.gz", "https://datasets.imdbws.com/title.ratings.tsv.gz", "https://datasets.imdbws.com/title.basics.tsv.gz")
for (url in urls) {
  filename =  paste(gsub('[^a-zA-Z]', '',url), '.tsv')
  filename = gsub('httpsdatasetsimdbwscom', '', filename)
  download.file(url, destfile = filename)
}

```

Load datasets

```{r}
episodes <- read_tsv('titleepisodetsvgz .tsv')
rating <- read_tsv('titleratingstsvgz .tsv')
names <- read_tsv('titlebasicstsvgz .tsv')
```

Count unique series and look at long series (seasons \>= 5)

```{r}
library(dplyr)
# filter the long series from episodes dataset
long_series<- episodes[episodes$seasonNumber >= 5, ]


# Use bind_rows() function to combine the three datasets row-wise
combined_dataset <- bind_rows(long_series, rating, names)

# use merge() to combined three datasets by "tconst" column
merged_dataset <- merge(long_series, rating, by = "tconst")
merged_dataset <- merge(merged_dataset, names, by = "tconst")

```
